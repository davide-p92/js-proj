import"./assets/modulepreload-polyfill-B5Qt9EMX.js";const p=document.getElementById("myfile"),o=document.getElementById("wasm-output"),c=document.getElementById("download-wat"),r=document.getElementById("download-zip");let l="",i=null,m="";p.addEventListener("change",async e=>{const t=e.target.files[0];if(!t){o.textContent="No file selected.";return}o.textContent="Uploading and converting...",c.disabled=!0,r.disabled=!0;const s=new FormData;s.append("file",t);try{const n=await fetch("/convert",{method:"POST",body:s});if(!n||!n.ok)throw new Error(`Server error: ${n.statusText}`);const u=await n.blob();i=u;const b=await JSZip.loadAsync(u),a=Object.values(b.files).find(f=>f.name.endsWith(".wat"));if(!a)throw new Error("WAT file not found in ZIP");const d=await a.async("text");l=d,m=a.name,o.textContent=d,o.textContent=d,c.disabled=!1,r.disabled=!1}catch(n){o.textContent=`Conversion failed: ${n.message}`,console.error(n)}});c.addEventListener("click",()=>{if(!l)return;const e=new Blob([l],{type:"text/plain"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=m||"output.wat",document.body.appendChild(t),t.click(),document.body.removeChild(t)});r.addEventListener("click",()=>{if(!i)return;const e=document.createElement("a");e.href=URL.createObjectURL(i),e.download="bundle.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e)});
